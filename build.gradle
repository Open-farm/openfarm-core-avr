apply from: 'util.gradle'
apply from: 'properties.gradle'

// This task simply runs everything.
task build(dependsOn:'gendocs') {
	//
}

// This task generates documentation.
task gendocs(dependsOn:'buildlibs') {
	doLast {
		exec_cmd([
			'doxygen',
			'.doxygen.config'])
	}
}

// This task build libs to static libraries.
task buildlibs {
	doLast { task ->
		exec_cmd(['mkdir', 'libs'])
		exec_cmd([
			'make',
			"ARDUINODIR=$arduinoDir",
			"CC=$cc",
			"ARCHIVER=$archiver",
			"CPUNAME=$cpuName",
			"CPUCLOCK=$cpuClock",
			"COREINC=-I$coreInc",
			"VARIANT=-I$arduinoVariant"])
	}
}

// Cleans lib + generated folders.
task clean {
	doLast {
		exec_cmd(['rm', '-rf', 'libs'])
		exec_cmd(['rm', '-rf', 'docs/generated/html'])
	}
}